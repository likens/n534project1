<html lang="en">

    <head>
        <title>TypeRacer</title>
        <meta name="viewport" content="width=device-width">
        <meta name="theme-color" content="#000000">
        <meta name="mobile-web-app-capable" content="yes">
        <link href="./assets/css/styles.css" rel="stylesheet">
    </head>

    <body>
        <div class="master">
            <div class="container">
                <div class="main">
                    <div class="title" id="title">
                        <div class="title__type">type racer <div class="title__cursor cursor"></div></div>
                    </div>
                    <div class="leaderboard menu hide" id="leaderboard">
                        <div class="leaderboard__title">Leaderboards</div>
                        <div class="leaderboard__selection">
                            <div class="leaderboard__type">
                                <div class="leaderboard__cat">Locale</div>
                                <select class="leaderboard__select leaderboard__locale" id="ddlLocale">
                                    <option>Global</option>
                                    <option>Friends</option>
                                    <option>Continent</option>
                                    <option>Country</option>
                                    <option>State/Province</option>
                                    <option>City</option>
                                </select>
                            </div>
                            <div class="leaderboard__type">
                                <div class="leaderboard__cat">Key Row</div>
                                <select class="leaderboard__select leaderboard__row" id="ddlRow">
                                    <option>Home Row</option>
                                    <option>Top Row</option>
                                    <option>Bottom Row</option>
                                </select>
                            </div>
                            <div class="leaderboard__type">
                                <div class="leaderboard__cat">Difficulty</div>
                                <select class="leaderboard__select leaderboard__skill" id="ddlSkill">
                                    <option>Easy</option>
                                    <option>Normal</option>
                                    <option>Hard</option>
                                    <option>Extreme</option>
                                </select>
                            </div>
                            <div class="leaderboard__type">
                                <div class="leaderboard__cat">Track</div>
                                <select class="leaderboard__select leaderboard__track" id="ddlTrack">
                                    <option>Alpine Access</option>
                                    <option>Tropical Tour</option>
                                    <option>Sunset Stretch</option>
                                    <!-- <option>Desert Drive</option> -->
                                </select>
                            </div>
                        </div>
                        <ul class="leaderboard__table" id="leaderboardTable">
                            <li class="leaderboard__item leaderboard__item--header">
                                <div class="leaderboard__column">Rank</div>
                                <div class="leaderboard__column">Name</div>
                                <div class="leaderboard__column">Racer</div>
                                <div class="leaderboard__column">Score</div>
                            </li>
                            <li class="leaderboard__item">
                                <div class="leaderboard__rank">1</div>
                                <div class="leaderboard__name">Parzival</div>
                                <div class="leaderboard__racer leaderboard__racer--blaze">Blaze</div>
                                <div class="leaderboard__score">100000</div>
                            </li>
                            <li class="leaderboard__item">
                                <div class="leaderboard__rank">2</div>
                                <div class="leaderboard__name">Flynn</div>
                                <div class="leaderboard__racer leaderboard__racer--alpha">Alpha</div>
                                <div class="leaderboard__score">90000</div>
                            </li>
                            <li class="leaderboard__item">
                                <div class="leaderboard__rank">3</div>
                                <div class="leaderboard__name">MADDMAXX</div>
                                <div class="leaderboard__racer leaderboard__racer--delta">Delta</div>
                                <div class="leaderboard__score">80000</div>
                            </li>
                            <li class="leaderboard__item">
                                <div class="leaderboard__rank">4</div>
                                <div class="leaderboard__name">Lightman</div>
                                <div class="leaderboard__racer leaderboard__racer--blaze">Blaze</div>
                                <div class="leaderboard__score">70000</div>
                            </li>
                            <li class="leaderboard__item">
                                <div class="leaderboard__rank">5</div>
                                <div class="leaderboard__name">NEO</div>
                                <div class="leaderboard__racer leaderboard__racer--alpha">Alpha</div>
                                <div class="leaderboard__score">60000</div>
                            </li>
                            <li class="leaderboard__item">
                                <div class="leaderboard__rank">6</div>
                                <div class="leaderboard__name">MacReady</div>
                                <div class="leaderboard__racer leaderboard__racer--delta">Delta</div>
                                <div class="leaderboard__score">50000</div>
                            </li>
                            <li class="leaderboard__item">
                                <div class="leaderboard__rank">7</div>
                                <div class="leaderboard__name">MyNameDoesntFi</div>
                                <div class="leaderboard__racer leaderboard__racer--blaze">Blaze</div>
                                <div class="leaderboard__score">40000</div>
                            </li>
                            <li class="leaderboard__item">
                                <div class="leaderboard__rank">8</div>
                                <div class="leaderboard__name">POWERGLOVIN</div>
                                <div class="leaderboard__racer leaderboard__racer--alpha">Alpha</div>
                                <div class="leaderboard__score">30000</div>
                            </li>
                            <li class="leaderboard__item">
                                <div class="leaderboard__rank">9</div>
                                <div class="leaderboard__name">Bob</div>
                                <div class="leaderboard__racer leaderboard__racer--delta">Delta</div>
                                <div class="leaderboard__score">20000</div>
                            </li>
                            <li class="leaderboard__item">
                                <div class="leaderboard__rank">10</div>
                                <div class="leaderboard__name">DOOMGUY</div>
                                <div class="leaderboard__racer leaderboard__racer--blaze">Blaze</div>
                                <div class="leaderboard__score">10000</div>
                            </li>
                        </ul>
                        <div class="leaderboard__back menu__back-btn">
                            <button class="leaderboard__btn menu__btn">&lt; Back</button>
                        </div>
                    </div>
                    <div class="how menu hide" id="how">
                        <div class="how__title">How To Play</div>
                        <div class="how__content">Something will go here</div>
                        <div class="how__back menu__back-btn">
                            <button class="how__btn menu__btn">&lt; Back</button>
                        </div>
                    </div>
                    <div class="story menu hide" id="menuStory">
                        <div class="story__title">In the far future of virtual worlds...</div>
                        <div class="story__content">Professional racing is no longer done with vehicles, but completed by those who can type on a physical keyboard the fastest. You've proven to be the best touch-typist from your virtual club and are entered into an amateur league to represent your peers. Do you have what it takes to climb the ranks, reach the top, and become a legendary type racer?</div>
                        <div class="story__next">
                            <button class="menu__next">Let's Do This !</button>
                        </div>
                        <div class="story__back">
                            <button class="menu__back">&lt; Back</button>
                        </div>
                    </div>
                    <div class="menus">
                        <div class="menu" id="menuBegin">
                            <ul>
                                <li>
                                    <button class="menu__next">Start</button>
                                </li>
                                <li>
                                    <button class="menu__btn">How To Play</button>
                                </li>
                                <li>
                                    <button class="menu__btn">Leaderboards</button>
                                </li>
                            </ul>
                        </div>
                        <div class="menu menu--racer hide" id="menuRacer">
                            <div class="menu__title">
                                <div class="menu__title-text">Select A Racer</div>
                            </div>
                            <ul>
                                <li>
                                    <button class="menu__next alpha">
                                        <div class="car">
                                            <img src="./assets/img/alpha_spin.gif" alt="" />
                                        </div>
                                        Alpha
                                    </button>
                                </li>
                                <li>
                                    <button class="menu__next delta">
                                        <div class="car">
                                            <img src="./assets/img/delta_spin.gif" alt="" />
                                        </div>
                                        Delta
                                    </button>
                                </li>
                                <li>
                                    <button class="menu__next blaze">
                                        <div class="car">
                                            <img src="./assets/img/blaze_spin.gif" alt="" />
                                        </div>
                                        Blaze
                                    </button>
                                </li>
                                <!-- <li>
                                    <button class="menu__next colemak">
                                        <div class="cube">
                                            <div class="one"></div>
                                            <div class="two"></div>
                                            <div class="three"></div>
                                            <div class="four"></div>
                                            <div class="five"></div>
                                            <div class="six"></div>
                                        </div>
                                        Colemak
                                    </button>
                                </li> -->
                                <li>
                                    <button class="menu__back">&lt; Back</button>
                                </li>
                            </ul>
                        </div>
                        <div class="menu menu--row hide" id="menuRow">
                            <div class="menu__title">
                                <div class="menu__title-text">Select A Key Row</div>
                            </div>
                            <ul>
                                <li>
                                    <button class="menu__next">
                                        <img src="./assets/img/row-home.png" alt="" />
                                        Home Row
                                    </button>
                                </li>
                                <li>
                                    <button class="menu__next">
                                        <img src="./assets/img/row-top.png" alt="" />
                                        Top Row
                                    </button>
                                </li>
                                <li>
                                    <button class="menu__next">
                                        <img src="./assets/img/row-bottom.png" alt="" />
                                        Bottom Row
                                    </button>
                                </li>
                                <li>
                                    <button class="menu__back">&lt; Back</button>
                                </li>
                            </ul>
                        </div>
                        <div class="menu menu--skill hide" id="menuSkill">
                            <div class="menu__title">
                                <div class="menu__title-text">Select A Difficulty</div>
                            </div>
                            <ul>
                                <li>
                                    <button class="menu__next">
                                        <div class="emoticon">(^_^)</div>
                                        Easy
                                    </button>
                                </li>
                                <li>
                                    <button class="menu__next">
                                        <div class="emoticon">(-_-)</div>
                                        Normal
                                    </button>
                                </li>
                                <li>
                                    <button class="menu__next">
                                        <div class="emoticon">(<small>o</small>_<small>o</small>)</div>
                                        Hard
                                    </button>
                                </li>
                                <li>
                                    <button class="menu__next">
                                        <div class="emoticon">(<small>x</small>_<small>x</small>)</div>
                                        Extreme
                                    </button>
                                </li>
                                <li>
                                    <button class="menu__back">&lt; Back</button>
                                </li>
                            </ul>
                        </div>
                        <!-- <div class="menu menu--mode hide" id="menuMode">
                            <div class="menu__title">
                                <div class="menu__title-text">Select A Mode</div>
                            </div>
                            <ul>
                                <li>
                                    <button class="menu__next">Solo</button>
                                </li>
                                <li>
                                    <button class="menu__next">Versus</button>
                                </li>
                                <li>
                                    <button class="menu__next">Practice</button>
                                </li>
                                <li>
                                    <button class="menu__back">&lt; Back</button>
                                </li>
                            </ul>
                        </div> -->
                        <div class="menu menu--track hide" id="menuTrack">
                            <div class="menu__title">
                                <div class="menu__title-text">Select A Track</div>
                            </div>
                            <ul>
                                <li>
                                    <button class="game__start mountain">Alpine Access</button>
                                </li>
                                <li>
                                    <button class="game__start tropical">Tropical Tour</button>
                                </li>
                                <li>
                                    <button class="game__start sunset">Sunset Stretch</button>
                                </li>
                                <!-- <li>
                                    <button class="game__start desert">Desert Drive</button>
                                </li> -->
                                <li>
                                    <button class="menu__back">&lt; Back</button>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="todo">
                    TODO:
                    <ul>
                        <li>Animate logo</li>
                        <li>select rider?</li>
                        <li>select difficulty? only on races/full word typing?</li>
                        <li>Left/right "letters"</li>
                        <li>Home Row: ASDFJKL;</li>
                        <li>Top Row: QWERTYUIOP</li>
                        <li>Bottom Row: ZXCVBNM,./</li>
                        <li>All Rows</li>
                        <li>Timer, accuracy</li>
                        <li>Sound on/off</li>
                        <li>pause button</li>
                        <li>lives</li>
                        <li>"coins"</li>
                        <li>Win Screen (play again / main menu)</li>
                        <li>Fail Screen (play again / main menu)</li>
                        <li>audio tunes & effects</li>
                        <li>some graphics for polygon vehicles</li>
                        <li>space to "jump" bottom obstacles?</li>
                    </ul>
                </div>
                <div class="game hide">
                    <div class="game__menu">
                        <button>Pause</button>
                        <button>Quit</button>
                    </div>
                    <div class="game__score" id="gameScore">99999999</div>
                </div>
                <div class="graph" id="graph">
                    <div class="lines lines--1"></div>
                    <div class="lines lines--2"></div>
                    <div class="lines lines--3"></div>
                    <div class="lines lines--4"></div>
                    <div class="lines lines--5"></div>
                    <div class="track"></div>
                    <div class="paths paths--1"></div>
                    <div class="paths paths--2"></div>
                    <div class="paths paths--3"></div>
                    <div class="racer racer--mid" id="racer">
                        <button class="racer__prompt racer__prompt--left" id="promptLeft">Q</button>
                        <img src="./assets/img/blaze_left.png" id="imgRacerLeft" class="racer__img racer__img--left" alt="" />
                        <img src="./assets/img/blaze_mid.png" id="imgRacerMid" class="racer__img racer__img--mid" alt="" />
                        <img src="./assets/img/blaze_right.png" id="imgRacerRight" class="racer__img racer__img--right" alt="" />
                        <button class="racer__prompt racer__prompt--right" id="promptRight">U</button>
                    </div>
                </div>
                <div class="footer">
                    <div class="version">v0.0.1 alpha</div>
                </div>
                <div class="status">
                    <div id="statusRacer"></div>
                    <div id="statusRow"></div>
                    <div id="statusSkill"></div>
                    <!-- <div id="statusMode"></div> -->
                    <div id="statusTrack"></div>
                </div>
                <div class="scanlines"></div>
                <!-- <div class="audio">
                    <audio id="audHover" autoplay="false">
                        <source src="./assets/audio/button_hover.mp3"></source>
                    </audio>
                    <audio id="audNext" autoplay="false">
                        <source src="./assets/audio/button_next.mp3"></source>
                    </audio>
                    <audio id="audBack" autoplay="false">
                        <source src="./assets/audio/button_back.mp3"></source>
                    </audio>
                </div> -->
            </div>
        </div>
    </body>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            const root = document.querySelector(":root");
            const title = document.getElementById("title");
            const graph = document.getElementById("graph");
            const leaderboard = document.getElementById("leaderboard");
            const racer = document.getElementById("racer");

            const hide = "hide";

            const leaderboardCategory = ["Global", "Country", "State", "City", "Friends"];
            const leaderboardRows = ["Home Row", "Top Row", "Bottom Row"];
            const leaderboardSkill = ["Easy", "Normal", "Hard", "Extreme"];
            const leaderboardTrack = ["Alpine Access", "Tropical Tour", "Sunset Stretch", "Desert Drive"];

            let menuIndex = 0;
            const menuStructure = ["begin", "story", "racer", "row", "skill", "track", "game"];
            const menus = [...document.getElementsByClassName("menu")];

            const btnNext = [...document.getElementsByClassName("menu__next")];
            const btnBack = [...document.getElementsByClassName("menu__back")];
            const btnStart = [...document.getElementsByClassName("game__start")];
            const btnMenu = [...document.getElementsByClassName("menu__btn")];

            const audHover = document.getElementById("audHover");
            const audNext = document.getElementById("audNext");
            const audBack = document.getElementById("audBack");

            const imgRacerLeft = document.getElementById("imgRacerLeft");
            const imgRacerMid = document.getElementById("imgRacerMid");
            const imgRacerRight = document.getElementById("imgRacerRight");

            const keysTopRowLeft = ["Q", "W", "E", "R", "T"] ;
            const keysTopRowRight = ["Y", "U", "I", "O", "P"];
            const keysHomeRowLeft = ["A", "S", "D", "F", "G",];
            const keysHomeRowRight = ["H", "J", "K", "L", ";", "'"];
            const keysBottomRowLeft = ["Z", "X", "C", "V", "B"];
            const keysBottomRowRight = ["N", "M", ",", ".", "/"];

            let activeRowLeft = [];
            let activeRowRight = [];

            btnMenu.forEach(btn => {
                btn.addEventListener('click', function() {
                    if (btn.textContent === "Leaderboards") {
                        leaderboard.classList.toggle(hide);
                    } else if (btn.textContent === "How To Play") {
                        how.classList.toggle(hide);
                    } else {
                        leaderboard.classList.add(hide);
                        how.classList.add(hide);
                    }
                    document.getElementById("menuBegin").classList.toggle(hide);
                    toggleTitle();
                });
            });

            btnNext.forEach(btn => {
                btn.addEventListener('click', function() {
                    let item = menuStructure[menuIndex];
                    updateStatus(item, btn.textContent.trim());
                    menuIndex++;
                    hideTitle(menuIndex);
                    hideMenus();
                    item = menuStructure[menuIndex];
                    showMenu(item);
                    // resetHover();
                    // playNext();
                });
                // btn.addEventListener('mouseenter', function() {
                //     console.log("got here");
                //     resetHover();
                //     audHover.play();
                // });
            });

            btnBack.forEach(btn => {
                btn.addEventListener('click', function() {
                    let item = menuStructure[menuIndex];
                    menuIndex--;
                    hideTitle(menuIndex);
                    hideMenus();
                    item = menuStructure[menuIndex];
                    updateStatus(item, "");
                    showMenu(item);
                    // audBack.pause();
                    // audBack.currentTime = 0;
                    // audBack.play();
                });
            });

            btnStart.forEach(btn => {
                btn.addEventListener('click', function() {
                    document.getElementById("statusTrack").innerText = btn.textContent;
                    const car = document.getElementById("statusRacer").innerText.trim().toLowerCase();
                    const row = document.getElementById("statusRow").textContent.replace(" Row", "").toLowerCase();
                    const difficulty = document.getElementById("statusSkill").innerText.trim().toLowerCase();
                    hideMenus();
                    graph.classList.add("graph--out");
                    // load racer image
                    imgRacerLeft.src = `./assets/img/${car}_left.png`;
                    imgRacerMid.src = `./assets/img/${car}_mid.png`;
                    imgRacerRight.src = `./assets/img/${car}_right.png`;
                    // load row compatibility
                    if (row === "top") {
                        activeRowLeft = keysTopRowLeft;
                        activeRowRight = keysTopRowRight;
                    } else if (row === "home") {
                        activeRowLeft = keysHomeRowLeft;
                        activeRowRight = keysHomeRowRight;
                    } else if (row === "bottom") {
                        activeRowLeft = keysBottomRowLeft;
                        activeRowRight = keysBottomRowRight;
                    }
                    setTimeout(() => {
                        graph.classList.remove("graph--out");
                        graph.classList.add("graph--game");
                        graph.classList.add(`graph--${[...btn.classList][1]}`);
                        graph.classList.add(`graph--${car}`);
                        graph.classList.add(`graph--${row}`);
                        graph.classList.add(`graph--${difficulty}`);
                        setTimeout(() => {
                            console.log(racer);
                            racer.classList.add("racer--ready");
                        }, 3600);
                    }, 2000);
                });
            });

            document.addEventListener('keyup', (e) => {
                if (e.code === "ArrowRight") {
                    generateRightKey();
                    if (racer.classList.contains("racer--mid")) {
                        racer.classList.remove("racer--mid");
                        racer.classList.add("racer--right");
                    } else if (racer.classList.contains("racer--left")) {
                        racer.classList.remove("racer--left");
                        racer.classList.add("racer--mid");
                    }
                } else if (e.code === "ArrowLeft") {
                    generateLeftKey();
                    if (racer.classList.contains("racer--mid")) {
                        racer.classList.remove("racer--mid");
                        racer.classList.add("racer--left");
                    } else if (racer.classList.contains("racer--right")) {
                        racer.classList.remove("racer--right");
                        racer.classList.add("racer--mid");
                    }
                } else if (e.code === "Space") {

                }
            });


            function updateStatus(item, text) {
                const status = document.getElementById(`status${item[0].toUpperCase() + item.slice(1)}`);
                if (status) {
                    status.innerText = text.includes("_") ? text.substring(5).trim() : text;
                }
            }

            function hideTitle(index) {
                index === 0 ? title.classList.remove(hide) : title.classList.add(hide)
            }

            function toggleTitle() {
                title.classList.toggle(hide);
            }

            function showMenu(item) {
                document.getElementById(`menu${item[0].toUpperCase() + item.slice(1)}`).classList.remove(hide);
            }

            function hideMenus() {
                menus.forEach(menu => menu.classList.add(hide));
            }

            // function resetHover() {
            //     audHover.pause();
            //     audHover.currentTime = 0;
            // }

            // function playNext() {
            //     resetHover();
            //     audNext.pause();
            //     audNext.currentTime = 0;
            //     audNext.play();
            // }

            function generateLeftKey() {
                promptLeft.innerText = activeRowLeft[activeRowLeft.length * Math.random() | 0];
            }

            function generateRightKey() {
                promptRight.innerText = activeRowRight[activeRowRight.length * Math.random() | 0];
            }

        });
    </script>

</html>